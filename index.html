<!DOCTYPE html>
<html>
<head>
    <title>Participant Management</title>
    <script src="https://apis.google.com/js/api.js"></script>
    <script>
        const CLIENT_ID = '536605246104-mbl42mmue73ju5b53h7ab8k4hrs5aes4.apps.googleusercontent.com';
        const SPREADSHEET_ID = '1N238nkONBqnrFKleXSjZueIwsJSsCr_VwL8RyFMjzX4';
        const SCOPES = 'https://www.googleapis.com/auth/spreadsheets';

        function handleClientLoad() {
            gapi.load('client:auth2', initClient);
        }

        function initClient() {
            gapi.client.init({
                apiKey: 'YOUR_API_KEY',
                clientId: CLIENT_ID,
                scope: SCOPES,
                discoveryDocs: ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
            }).then(function () {
                const GoogleAuth = gapi.auth2.getAuthInstance();
                GoogleAuth.isSignedIn.listen(updateSigninStatus);
                updateSigninStatus(GoogleAuth.isSignedIn.get());
            });
        }

        function updateSigninStatus(isSignedIn) {
            if (isSignedIn) {
                listParticipants();
            } else {
                document.getElementById('authorize_button').onclick = handleAuthClick;
                document.getElementById('signout_button').onclick = handleSignoutClick;
            }
        }

        function handleAuthClick() {
            const GoogleAuth = gapi.auth2.getAuthInstance();
            GoogleAuth.signIn();
        }

        function handleSignoutClick() {
            const GoogleAuth = gapi.auth2.getAuthInstance();
            GoogleAuth.signOut();
        }

        function listParticipants() {
            gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: SPREADSHEET_ID,
                range: 'Participants!A1:B',
            }).then(function(response) {
                const range = response.result;
                if (range.values.length > 0) {
                    let output = '<ul>';
                    range.values.forEach(function(row) {
                        output += `<li>${row[0]} - ${row[1]}</li>`;
                    });
                    output += '</ul>';
                    document.getElementById('participants_list').innerHTML = output;
                } else {
                    document.getElementById('participants_list').innerHTML = 'No participants found.';
                }
            }, function(response) {
                console.error('Error: ' + response.result.error.message);
            });
        }
    </script>
</head>
<body onload="handleClientLoad()">
    <h1>Participant Management</h1>
    <div id="participants_list"></div>
    <button id="authorize_button">Authorize</button>
    <button id="signout_button">Sign Out</button>
</body>
</html>